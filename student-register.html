<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Create account</title>
  <link rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap">

  <link rel="stylesheet" href="style.css">
</head>
<body>
      <div class="page-wrapper page-wrapper-wide">
            <div class="card card-wide">

      <h1 class="title">Create an account</h1>
            <form class="form form-grid-4" id="registerForm" autocomplete="off">

  <div class="form-item">
  <label for="firstName">First Name</label>
  <input id="firstName" type="text" ...>
</div>

<div class="form-item">
  <label for="lastName">Last Name</label>
  <input id="lastName" type="text" ...>
</div>

<div class="form-item">
  <label for="regEmail">Email Address</label>
  <input id="regEmail" type="email" ...>
</div>

<div class="form-item">
  <label for="course">Course</label>
  <select id="course" required>
    <option value="">Select course</option>
    <option value="CSE">CSE</option>
    <option value="IT">IT</option>
    <option value="AIDS">AIDS</option>
    <option value="EEE">EEE</option>
    <option value="ECE">ECE</option>
    <option value="BME">BME</option>
    <option value="M.Tech">M.Tech</option>
    <option value="ME">ME</option>
  </select>
</div>


<div class="form-item">
  <label for="batchNo">Batch No</label>
  <input id="batchNo" type="text" ...>
</div>

<div class="form-item">
  <label for="cgpa">CGPA</label>
  <input id="cgpa" type="number"
         step="0.01" min="0" max="10"
         placeholder="e.g. 8.2" required>
</div>

<div class="form-item">
  <label for="arrears">No Of Arrears</label>
  <input id="arrears" type="number"
         min="0" step="1"
         placeholder="e.g. 0" required>
</div>

<div class="form-item">
  <label for="rollNo">Roll Number</label>
  <input id="rollNo" type="text" ...>
</div>


<div class="form-item">
  <label for="address">Address</label>
  <textarea id="address" rows="3" ...></textarea>
</div>
<div class="form-item">
  <label for="fatherName">Father name</label>
  <input id="fatherName" type="text"
         pattern="[A-Za-z\s]+"
         required>
</div>

<div class="form-item">
  <label for="gender">Gender</label>
  <select id="gender" required>
    <option value="">Select gender</option>
    <option value="Male">Male</option>
    <option value="Female">Female</option>
    <option value="Other">Other</option>
  </select>
</div>

<div class="form-item">
  <label for="dob">D.O.B</label>
  <input id="dob" type="date" required>
</div>

<div class="form-item">
  <label for="mobileNumber">Phone number</label>
  <input id="mobileNumber" type="tel"
         placeholder="10-digit mobile"
         pattern="[0-9]{10}"
         required>
</div>


<div class="form-item">
  <label for="regPassword">Password</label>
  <input id="regPassword" type="password" ...>
</div>

<div class="form-item">
  <label for="confirmPassword">Confirm Password</label>
  <input id="confirmPassword" type="password" ...>
</div>

<div class="form-full">
  <p id="pwdError" class="error-text"></p>
  <button type="submit" class="btn-primary">Create account</button>
  <div class="back-login-wrapper">
    <a href="login.html" class="btn-back">Back to login</a>
  </div>

</div>

</form>


  <script>
    window.addEventListener('pageshow', function (event) {
    const form = document.getElementById('registerForm');
    if (!form) return;
    form.reset();    
  });

  const form       = document.getElementById('registerForm');
  const regEmail   = document.getElementById('regEmail');
  const pwd        = document.getElementById('regPassword');
  const confirmPwd = document.getElementById('confirmPassword');
  const errorText  = document.getElementById('pwdError');

  form.addEventListener('submit', function (e) {
    e.preventDefault(); // stop normal submit

    if (/[A-Z]/.test(regEmail.value)) {
      errorText.textContent = 'Email must be in lowercase only.';
      return;
    }
    if (!form.checkValidity()) return;

    if (pwd.value !== confirmPwd.value) {
      errorText.textContent = 'Password and Confirm password must match.';
      return;
    }

    errorText.textContent = '';

        fetch('http://localhost:3000/api/register', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },

      body: JSON.stringify({
        firstName: document.getElementById('firstName').value,
        lastName: document.getElementById('lastName').value,
        email: regEmail.value,
        password: pwd.value,
        course: document.getElementById('course').value,
        batchNo: document.getElementById('batchNo').value,
        cgpa: Number(document.getElementById('cgpa').value),
        noOfArrears: Number(document.getElementById('arrears').value),
        rollNo: document.getElementById('rollNo').value,
        address: document.getElementById('address').value,
        fatherName: document.getElementById('fatherName').value,
        gender: document.getElementById('gender').value,
        dob: document.getElementById('dob').value,
        mobileNumber: document.getElementById('mobileNumber').value
})


    })

    .then(res => res.json())
    .then(data => {
      alert(data.message);
      window.location.href = 'login.html';

    })
    .catch(() => {
      errorText.textContent = 'Error while saving data. Try again.';
    });
  });
</script>


</body>
</html>
